---
title: 建站——从0到1全流程
date: 2023-02-14 17:34:37
tags: hexo
type: "categories"
categories:
  - 工具
---

### 一、域名部署

#### 1.生成托管地址

- 使用用户名新建一个以`.github.io`结尾的仓库

  ![1](1.png)

- 查看生成的域名（当然这个时候仓库里没有东西应该访问不到）
  ![2](2.png)

#### 2.连接仓库并推送代码

- 首次推送

```bash
# 注意切换到科学上网的端口

git init

git remote add origin + 地址

git add .

git commit -m "first commit"

git push -u origin main   #注意github默认是main不是master

hexo g -d   #一键部署
```

- 之后的提交

```bash
# 注意切换到科学上网的端口

git fetch

git pull origin main --allow-unrelated-histories（允许提交不关联的历史代码。）

git add .

git commit - "提交说明"

git push

hexo g -d   #一键部署
```

### 二、hexo 搭建项目

- 在指定的目录下打开 cmd

```bash
npm install -g hexo-cli

hexo init yby2020 #这里可以自定义名字

```

- vscode 打开项目

```bash
# 安装依赖
yarn

#启动项目
hexo g
hexo server
```

- 切换 fluid 博客主题（详见官方文档：[hexo-theme-fluid](https://github.com/fluid-dev/hexo-theme-fluid)）

```bash
yarn add hexo-theme-fluid

#如下修改 Hexo 博客目录中的 _config.yml
theme: fluid  # 指定主题
language: zh-CN  # 指定语言，会影响主题显示的语言，按需修改

npm update --save hexo-theme-fluid # 最后更新主题
```

- 自动部署配置

```bash
yarn add hexo-deployer-git

修改根目录下的 _config.yml，配置 GitHub 相关信息
deploy:
  type: git
  repo: https://github.com/YBY2020/YBY2020.github.io.git
  branch: main
  token: ***
```

- github token 获取

![4](4.png)

### 三、hexo 配置

- 官方文档：[Hexo Fluid 用户手册](https://hexo.fluid-dev.com/docs/guide/#%E5%85%B3%E4%BA%8E%E6%8C%87%E5%8D%97)

- 官方示例：[Hexo Theme Fluid](https://hexo.fluid-dev.com/)

- 仅介绍具有代表性的配置

#### 1.mac 风格代码块

- 在 source 文件夹下新建`/source/css/fluid-extension.css`（此处可添加任何覆盖样式）

  ![3](3.png)

- 打开主题的配置文件`_config.fluid.yml`，在 `custom_css` 里添加刚才的文件。

```bash
custom_css: "/css/fluid-extension.css"
```

- mac 风格代码块

```css
/* 控制代码框顶栏颜色、宽度、圆角等 */
figure.highlight {
  background: rgb(246, 248, 250);
  border-radius: 8px;
  box-shadow: 1px 1px 4px -1px rgba(0, 0, 0, 0.3);
  padding-top: 25px;
  z-index: 998;
}

/* 绘制三个小圆点 */
figure.highlight::before {
  background: #fc625d;
  border-radius: 50%;
  box-shadow: 20px 0 #fdbc40, 40px 0 #35cd4b;
  content: " ";
  height: 12px;
  left: 12px;
  margin-top: -15px;
  position: absolute;
  width: 12px;
  z-index: 999;
}
```

#### 2.代码时效性提醒

- 在 source 文件夹下新建`/source/js/date.js`（js 目录下集中存放注入代码，并统一引入）

```js
(function () {
  var times = document.getElementsByTagName("time");
  if (times.length === 0) {
    return;
  }
  var posts = document.getElementsByClassName("post-content");
  if (posts.length === 0) {
    return;
  }

  var pubTime = new Date(times[0].dateTime); /* 文章发布时间戳 */
  var now = Date.now(); /* 当前时间戳 */
  var interval = parseInt(now - pubTime);
  /* 发布时间超过指定时间（毫秒）才会显示 */
  if (interval > 3600 * 24 * 30 * 1000) {
    var days = parseInt(interval / 86400000);
    posts[0].insertAdjacentHTML(
      "afterbegin",
      '<div class="note note-warning" style="font-size:0.9rem"><p>' +
        '<div class="h6">文章时效性提示</div><p>这是一篇发布于 ' +
        days +
        " 天前的文章，部分信息可能已发生改变，请注意甄别。" +
        "</p></p></div>"
    );
  }
})();
```

- 在根目录下新建 scripts 文件夹，并新建一个 index.js 文件，注入 js 代码

```js
hexo.extend.injector.register(
  "body_end",
  `
  <script src="/js/date.js"></script>
`
);
```

### 参考

> [GitHub Pages + Hexo 搭建个人博客网站，史上最全教程](https://blog.csdn.net/yaorongke/article/details/119089190)
